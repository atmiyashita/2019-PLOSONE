x<-d.sum
beeswarm(PO12 ~ MuscleCol, data=x,col=c("magenta", "grey"), pch=19)
boxplot(PO12~ MuscleCol, data=x, col="#00000030", add=T, outline=F,axes=F)
summary(lm(PO12~MuscleCol+ as.factor(Group.Number), data=x))
beeswarm(PO22 ~ MuscleCol, data=x,col=c("magenta", "grey"), pch=19)
boxplot(PO22~ MuscleCol, data=x, col="#00000030", add=T, outline=F,axes=F)
summary(lm(PO22~MuscleCol+ as.factor(Group.Number), data=x))
beeswarm(PO36 ~ MuscleCol, data=x,col=c("magenta", "grey"), pch=19)
boxplot(PO36~ MuscleCol, data=x, col="#00000030", add=T, outline=F,axes=F)
summary(lm(PO36~MuscleCol+ as.factor(Group.Number), data=x))
beeswarm(lyso12 ~ MuscleCol, data=x,col=c("magenta", "grey"), pch=19)
boxplot(lyso12~ MuscleCol, data=x, col="#00000030", add=T, outline=F,axes=F)
summary(lm(lyso12~MuscleCol+ as.factor(Group.Number), data=x))
beeswarm(lyso22 ~ MuscleCol, data=x,col=c("magenta", "grey"), pch=19)
boxplot(lyso22~ MuscleCol, data=x, col="#00000030", add=T, outline=F,axes=F)
summary(lm(lyso22~MuscleCol+ as.factor(Group.Number), data=x))
beeswarm(jitter(lyso36, amount=.5) ~ MuscleCol, data=x,col=c("magenta", "grey"), pch=19)
boxplot(lyso36~ MuscleCol, data=x, col="#00000030", add=T, outline=F,axes=F)
summary(lm(lyso36~MuscleCol+ as.factor(Group.Number), data=x))
x <- d.sum[is.element(d.sum$Group.Number, c(1,2,3,4,5,6,7)),]
x$Sep.Date <-format(as.Date(x$Sep.Date), "%Y-%m")
x <- x[x$IsMated & x$IsEggComplete & x$EventDay==36 & x$EventType=="C",]
x7 <-nrow(x[x$Group.Number == 7, ]);x7
x[x$Group.Number==7,]$Group.Number <- rep(0,x7)
nrow(x)
par(mfrow = c(2,2),
oma = c(1,1,1,1) + 0.1,
mar = c(3,3,1,.5) + 0.1,
mgp=c(1.8,.6,0),adj=.5,
bg="white")
table (x[!is.na(x$EggsInLO),]$Group.Number)
mean (x$Neggs22 - x$Neggs12)
mean (x$Neggs36 - x$Neggs22)
wilcox.test( (x$Neggs22 - x$Neggs12)/10,
(x$Neggs36 - x$Neggs22)/14)
wilcox.test( (x$Neggs22 - x$Neggs12)/10,
(x$Neggs36 - x$Neggs22)/14, paired = T)
?wilcox.test
## N. of Eggs 12-36 - Treatment
hist(x$Neggs36-x$Neggs12)
shapiro.test(x$Neggs36-x$Neggs12);shapiro.test(log10(x$Neggs36-x$Neggs12+1))
mean(x$Neggs36 - x$Neggs12)
var(x$Neggs36 - x$Neggs12)
res <-kruskal.test((Neggs36 - Neggs12) ~  as.factor(Group.Number), data=x[is.element(x$Group.Number, c(1,3,5,0)),])
res
xx<-x[is.element(x$Group.Number, c(1,3,5,0)),]
pairwise.wilcox.test((xx$Neggs36 - xx$Neggs12), as.factor(xx$Group.Number))
res4b <- glm.nb((Neggs36 - Neggs12) ~  as.factor(Group.Number),link ="log",
data=x[is.element(x$Group.Number, c(1,3,5,0)),])
res5b <- glm.nb((Neggs36 - Neggs12) ~  1                      ,link ="log",
data=x[is.element(x$Group.Number, c(1,3,5,0)),])
AIC(res4b);AIC(res5b); AIC(res4b)-AIC(res5b)
summary(res4b)
summary(res5b)
sum(print(table(x$Group.Number)))
hist(x[x$Group.Number==0,]$Neggs36 - x[x$Group.Number==0,]$Neggs12)
### Power Analysis
posi.rate <- c()
sampsize.range <- seq(from = 20, to = 1000, by = 40)
summary(res4b)
plot (x= sampsize.range, y = posi.rate, type="p",pch=19, ylim=c(0, 1), ylab="Power", xlab="Sample size")
segments(0, 0.8, 500, 0.8, lty=3)
# res6 <- glm((Neggs36 - Neggs12) ~  as.factor(Group.Number),
#              data=x[is.element(x$Group.Number, c(1,3,5,0)),], family=poisson(link="log"))
# res7 <- glm((Neggs36 - Neggs12) ~  1                      ,
#              data=x[is.element(x$Group.Number, c(1,3,5,0)),], family=poisson(link="log"))
# AIC(res6);AIC(res7); AIC(res6)-AIC(res7)
# summary(res6)
beeswarm(Neggs36 - Neggs12 ~ as.factor(Group.Number),
spacing=.75, data=x[is.element(x$Group.Number, c(1,3,5,0)),],
col="#000000aa",
pch=19, las=1, ylim= c(0, 500))
xx<-x[is.element(x$Group.Number, c(1,3,5,0)) & !is.na(x$Neggs36-x$Neggs12),]
means<-tapply(xx$Neggs36-xx$Neggs12, INDEX = xx$Group.Number, FUN=mean, na.rm=T);means
for(i in 1:4){segments(i-.2,means[i],i+.2, means[i], lwd = 3, col = "red")}
boxplot(Neggs36 - Neggs12 ~ as.factor(Group.Number),
data=x[is.element(x$Group.Number, c(1,3,5,0)),],
pch=19, las=1, ylim= c(0, 400), outline=F,
ylab="# Eggs laid between d12 and d36")
meds<-tapply(xx$Neggs36-xx$Neggs12, INDEX = xx$Group.Number, FUN=median, na.rm=T);meds
## N. of Eggs 22-36 - Treatment
hist(x$Neggs36-x$Neggs22); hist(x$Neggs36-x$Neggs22, breaks=20)
hist(log10(x$Neggs36-x$Neggs22))
shapiro.test(log10(x$Neggs36-x$Neggs22+1))
mean(x$Neggs36 - x$Neggs22)
var(x$Neggs36 - x$Neggs22)
res4b <- glm.nb((Neggs36 - Neggs22) ~  as.factor(Group.Number),link ="log",
data=x[is.element(x$Group.Number, c(2,4,6,0)),])
res5b <- glm.nb((Neggs36 - Neggs22) ~  1                      ,link ="log",
data=x[is.element(x$Group.Number, c(2,4,6,0)),])
AIC(res4b);AIC(res5b); AIC(res4b)-AIC(res5b)
summary(res4b)
beeswarm(Neggs36 - Neggs22 ~ as.factor(Group.Number),
spacing=.75,
data=x[is.element(x$Group.Number, c(2,4,6,0)),], col="#000000aa",
pch=19,
las=1, ylim=c(0, 500))
res4 <- glm((Neggs15 - Neggs12) ~  as.factor(Group.Number), offset = log(EggsTotal+1),
data=x[is.element(x$Group.Number, c(1,3,5,0)),], family=poisson(link="log"))
res5 <- glm((Neggs15 - Neggs12) ~  1                      , offset=log(EggsTotal+1) ,
data=x[is.element(x$Group.Number, c(1,3,5,0)),], family=poisson(link="log"))
AIC(res4);AIC(res5); AIC(res4)-AIC(res5)
summary(res4); exp(0.58)
res4 <- glm((Neggs19 - Neggs15) ~  as.factor(Group.Number), offset = log(EggsTotal+1),
data=x[is.element(x$Group.Number, c(1,3,5,0)),], family=poisson(link="log"))
res5 <- glm((Neggs19 - Neggs15) ~  1                      , offset=log(EggsTotal+1) ,
data=x[is.element(x$Group.Number, c(1,3,5,0)),], family=poisson(link="log"))
AIC(res4);AIC(res5); AIC(res4)-AIC(res5)
summary(res4); exp(0.58)
nrow(x)
res4 <- glm.nb((Neggs15 - Neggs12) ~  as.factor(Group.Number), offset = log(EggsTotal+1),
data=x[is.element(x$Group.Number, c(1,3,5,0)),], family=poisson(link="log"))
d <- d.sum[d.sum$IsMated & d.sum$IsEggComplete & !is.na(d.sum$RVtot) &
d.sum$EventDay==36 & d.sum$EventType=="C",
c("RV7","RV12","RV15","RV19","RV22","RV25","RV30","RV36","RRV36","ID","Group.Number")]
d <- round(d, 1)
d <- d[is.element(d$Group.Number, c(1,2,3,4,5,6,7)),]
summary(d)
dd.sum <- d.sum[d.sum$IsMated & d.sum$IsEggComplete & !is.na(d.sum$RVtot) &
d.sum$EventDay==36 & d.sum$EventType=="C" & is.element(d.sum$Group.Number,1:7),]
nrow(d); nrow(dd.sum) ## 136 samples, complete dataset, survived for 36 days,
## Cumulative
par(mfrow=c(3,3))
for (grn in 1:7){
counter <- 0
plot(x=NULL, type="n", xlim=c(0, 40), ylim = c(0,4),
xlab='Day', ylab='log10(RV+1)', las=1,
main = paste("Reproductive output (Group ", grn,")", sep="") )
for (i in 1:nrow(d)){
x <- d.eggperday[d.eggperday$ID==d[i,]$ID & d.eggperday$Gr.N==grn,]
if(nrow(x)==0){next}
xx <-c(0)
yy <-c(0)
counter <- counter +1
for (k in 1:nrow(x)){
xx <- c(xx, x[k,]$Day.mean)
yy <- c(yy, sum(x[1:k, ]$RV, na.rm=T))
}
par(new=T)
plot(x=xx, y=log10(yy+1), type="l", xlim=c(0, 40), ylim = c(0, 3), axes = F,
xlab="", ylab="", col=1)
rm(xx, yy)
}
xxx <- d[d$Group.Number==grn,]
par(new=T)
plot(x=c(3.5,9.5,13.5,17,20.5,23.5,27.5,33),y=apply(log10(xxx[,1:8]+1), 2, mean, na.rm=T),
pch= 19, col="red",xlim=c(0, 40), ylim=c(0,3),axes=F,xlab="", ylab="")
par(new=T)
plot(x=c(3.5,9.5,13.5,17,20.5,23.5,27.5,33),y=apply(log10(xxx[,1:8]+1), 2, mean, na.rm=T),
pch= 19, col="red",xlim=c(0, 40), ylim=c(0,3),axes=F,xlab="", ylab="", type="l")
par(new=F)
legend("topleft", legend=paste("n=",counter,sep=""), bty="n", text.col = 1)
}
## Non-Cumulative
par(mfrow=c(1,1))
for (grn in 1:7){
counter <- 0
plot(x=NULL, type="n", xlim=c(0, 40), ylim = c(0,4),
xlab='Day', ylab='log10(RVnc+1)',
main = paste("Reproductive output (Group ", grn,")", sep="") )
for (i in 1:nrow(d)){
x <- d.eggperday[d.eggperday$ID==d[i,]$ID & d.eggperday$Gr.N==grn,]
if(nrow(x)==0){next}
xx <-c(0)
yy <-c(0)
counter <- counter +1
for (k in 1:nrow(x)){
xx <- c(xx, x[k,]$Day.mean)
yy <- c(yy, x[k, ]$RV)
}
par(new=T)
plot(x=xx, y=log10(yy+1), type="l", xlim=c(0, 40), ylim = c(0, 3), axes = F,
xlab="", ylab="", col=1)
rm(xx, yy)
}
legend("topleft", legend=paste("n=",counter,sep=""), bty="n", text.col = 1)
}
x <- d.sum.RFclusters[is.element(d.sum$Group.Number, c(1,2,3,4,5,6,7)),]
x <- cbind(x, Sep.Mon=months.Date(x$Sep.Date))
x <- x[x$IsMated & x$IsEggComplete & x$EventDay==36 & x$EventType=="C" & !is.na(x$RVtot),]
nrow(x)
res<-lmer(log10(RV7+1)~as.factor(Group.Number) + (1| Sep.Mon) ,data=x);summary(res)
x <- d.sum.RFclusters[is.element(d.sum$Group.Number, c(1,2,3,4,5,6,7)),]
x <- cbind(x, Sep.Mon=months.Date(x$Sep.Date))
x <- x[x$IsMated & x$IsEggComplete & x$EventDay==36 & x$EventType=="C" & !is.na(x$RVtot),]
nrow(x)
res<-lmer(log10(RV7+1)~as.factor(Group.Number) + (1| Sep.Mon) ,data=x);summary(res)
res<-lmer(log10(RV12+1)~as.factor(Group.Number) + (1| Sep.Mon) ,data=x);summary(res)
res<-lmer(log10(RV15+1)~as.factor(Group.Number) + (1| Sep.Mon) ,data=x);summary(res)
res<-lmer(log10(RV19+1)~as.factor(Group.Number) + (1| Sep.Mon) ,data=x);summary(res)
x <- d.sum[is.element(d.sum$Group.Number, c(1,2,3,4,5,6,7)),]
x$Sep.Date <-format(as.Date(x$Sep.Date), "%Y-%m")
x <- x[x$IsMated & x$EventDay==36 & x$EventType=="C",]
x7 <-nrow(x[x$Group.Number == 7, ]);x7
x[x$Group.Number==7,]$Group.Number <- rep(0,x7)
# x <- x[x$IsMated&
#          !(x$EventDay==12 & x$EventType=="C") &
#          !(x$EventDay==22 & x$EventType=="C"),]
sum(print(table(x$Group.Number)))
par(mfcol = c(4,3),
oma = c(1,1,1,1) + 0.1,
mar = c(3,3,1,.5) + 0.1,
mgp=c(1.8,.6,0),adj=.5,
bg="transparent")
# Sample sizes
table(x[!is.na(x$PO12),]$Group.Number)
table(x[!is.na(x$GSH12),]$Group.Number)
table(x[!is.na(x$lyso12),]$Group.Number)
table(x[!is.na(x$ProtLevel12),]$Group.Number)
table(x[!is.na(x$PO22),]$Group.Number)
table(x[!is.na(x$GSH22),]$Group.Number)
table(x[!is.na(x$lyso22),]$Group.Number)
table(x[!is.na(x$ProtLevel22),]$Group.Number)
table(x[!is.na(x$PO36),]$Group.Number)
table(x[!is.na(x$GSH36),]$Group.Number)
table(x[!is.na(x$lyso36),]$Group.Number)
table(x[!is.na(x$ProtLevel36),]$Group.Number)
# BOXPLOTS
boxplot(PO12~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(1,3,5)),],las=1,outline=F)
boxplot(GSH12~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(1,3,5)),],las=1,outline=F)
boxplot(lyso12~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(1,3,5)),],las=1,outline=F)
boxplot(ProtLevel12~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(1,3,5)),],las=1,outline=F)
boxplot(PO22~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(2,4,6)),],las=1,outline=F)
boxplot(GSH22~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(2,4,6)),],las=1,outline=F)
boxplot(lyso22~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(2,4,6)),],las=1,outline=F)
boxplot(ProtLevel22~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(2,4,6)),],las=1,outline=F)
boxplot(PO36~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(0:6)),],las=1,outline=F)
boxplot(GSH36~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(0:6)),],las=1,outline=F)
boxplot(lyso36~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(0:6)),],las=1,outline=F)
boxplot(ProtLevel36~as.factor(Group.Number),
data=x[is.element(x$Group.Number,c(0:6)),],las=1,outline=F)
#PO12
hist(x$PO12)
#PO12
hist(x$PO12)
shapiro.test(x$PO12)
shapiro.test(log10(x$PO12+1))
res4 <- glmer( PO12/mean(x$PO12,na.rm=T)+.11 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
res5 <- glmer( PO12/mean(x$PO12,na.rm=T)+.11 ~                         + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
AIC(res4);AIC(res5)
summary(res4)
shapiro.test(x$GSH12)
res4 <- glmer( GSH12+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
res5 <- glmer( GSH12+.1 ~                         + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
res4 <- glmer( GSH12+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
res5 <- glmer( GSH12+.1 ~                         + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
summary(res4)
#GSH12
hist(x$GSH12)
x <- d.sum[is.element(d.sum$Group.Number, c(1,2,3,4,5,6,7)),]
x$Sep.Date <-format(as.Date(x$Sep.Date), "%Y-%m")
x <- x[x$IsMated & x$EventDay==36 & x$EventType=="C",]
x7 <-nrow(x[x$Group.Number == 7, ]);x7
x[x$Group.Number==7,]$Group.Number <- rep(0,x7)
# x <- x[x$IsMated&
#          !(x$EventDay==12 & x$EventType=="C") &
#          !(x$EventDay==22 & x$EventType=="C"),]
sum(print(table(x$Group.Number)))
#GSH12
hist(x$GSH12)
shapiro.test(x$GSH12)
res4 <- glmer( GSH12+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
res5 <- glmer( GSH12+.1 ~                         + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
summary(res4)
#lyso12
hist(x$lyso12)
shapiro.test(x$lyso12)
res4 <- glmer( lyso12+.5 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
res5 <- glmer( lyso12+.5 ~                         + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
AIC(res4);AIC(res5)
# res6 <- glm(  lyso12+.1 ~ as.factor(Group.Number) ,data=x, family= Gamma(link="log"))
# res7 <- glm(  lyso12+.1 ~ 1                       ,data=x, family= Gamma(link="log"))
# AIC(res6);AIC(res7)
# summary(lm(lyso12~as.factor(Group.Number) + Sep.Mon, data =x))
# res1<-lmer(log10(lyso12+1)~as.factor(Group.Number) + (1| Sep.Mon) ,data=x)
# AIC(res1)
# res2<-lmer(log10(lyso12+1)~as.factor(Group.Number) + (1 + as.factor(Group.Number)| Sep.Mon),data=x)
# AIC(res2)
# anova(res1,res2)
# summary(res1)
beeswarm(lyso12~as.factor(Group.Number),spacing=.6,
data=x[is.element(x$Group.Number,c(1,3,5)),], col=c("black","red","grey"), pch=19,
ylab="Lysozyme", main="Day 12",las=1)
res4 <- glmer( GSH12+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
res5 <- glmer( GSH12+.1 ~                         + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
#GSH12
hist(x$GSH12)
shapiro.test(x$GSH12)
res4 <- glmer( GSH12+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
res5 <- glmer( GSH12+.1 ~                         + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
x <- d.sum[is.element(d.sum$Group.Number, c(1,2,3,4,5,6,7)),]
x$Sep.Date <-format(as.Date(x$Sep.Date), "%Y-%m")
#GSH12
hist(x$GSH12)
shapiro.test(x$GSH12)
res4 <- glmer( GSH12+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
res5 <- glmer( GSH12+.1 ~                         + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
#PO12
hist(x$PO12)
shapiro.test(x$PO12)
shapiro.test(log10(x$PO12+1))
res4 <- glmer( PO12/mean(x$PO12,na.rm=T)+.11 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
res5 <- glmer( PO12/mean(x$PO12,na.rm=T)+.11 ~                         + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
AIC(res4);AIC(res5)
x <- d.sum[is.element(d.sum$Group.Number, c(1,2,3,4,5,6,7)),]
x$Sep.Date <-format(as.Date(x$Sep.Date), "%Y-%m")
x <- x[x$IsMated & x$EventDay==36 & x$EventType=="C",]
sum(print(table(x$Group.Number)))
par(mfcol = c(4,3),
oma = c(1,1,1,1) + 0.1,
mar = c(3,3,1,.5) + 0.1,
mgp=c(1.8,.6,0),adj=.5,
bg="transparent")
# Sample sizes
table(x[!is.na(x$PO12),]$Group.Number)
table(x[!is.na(x$GSH12),]$Group.Number)
table(x[!is.na(x$lyso12),]$Group.Number)
table(x[!is.na(x$ProtLevel12),]$Group.Number)
table(x[!is.na(x$PO22),]$Group.Number)
table(x[!is.na(x$GSH22),]$Group.Number)
table(x[!is.na(x$lyso22),]$Group.Number)
table(x[!is.na(x$ProtLevel22),]$Group.Number)
table(x[!is.na(x$PO36),]$Group.Number)
table(x[!is.na(x$GSH36),]$Group.Number)
table(x[!is.na(x$lyso36),]$Group.Number)
table(x[!is.na(x$ProtLevel36),]$Group.Number)
x <- x[x$IsMated & x$EventDay==36 & x$EventType=="C" & x$IsEggComplete,]
x[x$Group.Number==7,]$Group.Number <- rep(0,x7)
#PO12
hist(x$PO12)
shapiro.test(x$PO12)
shapiro.test(log10(x$PO12+1))
res4 <- glmer( PO12/mean(x$PO12,na.rm=T)+.11 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
res5 <- glmer( PO12/mean(x$PO12,na.rm=T)+.11 ~                         + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
AIC(res4);AIC(res5)
#GSH12
hist(x$GSH12)
shapiro.test(x$GSH12)
res4 <- glmer( GSH12+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
res5 <- glmer( GSH12+.1 ~                         + (1| Sep.Date) ,data=x, family=gaussian(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
summary(res4)
#lyso12
hist(x$lyso12)
shapiro.test(x$lyso12)
res4 <- glmer( lyso12+.5 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
res5 <- glmer( lyso12+.5 ~                         + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
AIC(res4);AIC(res5)
#ProtLevel12
hist(x$ProtLevel12)
shapiro.test(x$ProtLevel12)
res4 <- glmer(ProtLevel12/mean(ProtLevel12,na.rm=T)+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family=Gamma(link="log"))
res5 <- glmer(ProtLevel12/mean(ProtLevel12,na.rm=T)+.1 ~                           (1| Sep.Date) ,data=x, family=Gamma(link="log"))
AIC(res4);AIC(res5); AIC(res4)-AIC(res5)
summary(res4)
# res6 <- glm( ProtLevel12+.1 ~ as.factor(Group.Number) ,data=x, family= Gamma(link="log"))
# res7 <- glm( ProtLevel12+.1 ~ 1                       ,data=x, family= Gamma(link="log"))
# AIC(res6);AIC(res7)
# summary(res6)
beeswarm(ProtLevel12~ as.factor(Group.Number),spacing=.6,
data=x[is.element(x$Group.Number,c(1,3,5)),], col=c("black","red","grey"), pch=19,
ylab="ProtLevel", main="Day 12",las=1)
#PO22
hist(x$PO22)
shapiro.test(x$PO22)
shapiro.test(log10(x$PO22+1))
res4 <- glmer( PO22+.1 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
res5 <- glmer( PO22+.1 ~                         + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
AIC(res4);AIC(res5)
#PO22toGSH22
xx <- x[x$PO22>0 & x$GSH22 >0,]
hist( (xx$PO22+.1)/(xx$GSH22+.1) )
res4 <- glmer( (PO22+1)/(GSH22+1) ~ as.factor(Group.Number) + (1| Sep.Date) ,data=xx, family=Gamma(link="log"))
res5 <- glmer( (PO22+1)/(GSH22+1) ~                         + (1| Sep.Date) ,data=xx, family=Gamma(link="log"))
AIC(res4);AIC(res5); AIC(res4)-AIC(res5)
summary(res4)
res4 <- glmer( lyso22/mean(lyso22,na.rm=T)+.4 ~ as.factor(Group.Number) + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
res5 <- glmer( lyso22/mean(lyso22,na.rm=T)+.4 ~                         + (1| Sep.Date) ,data=x, family= Gamma(link="log"))
AIC(res4);AIC(res5); AIC(res4)- AIC(res5)
summary(res4)
res6 <- glm( lyso22+.1 ~ as.factor(Group.Number) ,data=x, family= Gamma(link="log"))
res7 <- glm( lyso22+.1 ~ 1                       ,data=x, family= Gamma(link="log"))
AIC(res6);AIC(res7)
summary(res6)
#ProtLevel22
hist(x$ProtLevel22)
shapiro.test(x$ProtLevel22)
shapiro.test(log10(x$ProtLevel22+1))
par(mfrow = c(2,2),
oma = c(1,1,1,1) + 0.1,
mar = c(6,3,0,.5) + 0.1,
mgp=c(2,.6,0),adj=.5,
bg="transparent")
x <- d.sum[is.element(d.sum$Group.Number, c(1,2,7)),]
x <- cbind(x, Sep.Mon=months.Date(x$Sep.Date))
x <- x[x$IsMated & x$EventDay==36 & x$EventType=="C",]
x.tab <- cbind(PO= c(x$PO12, x$PO22, x$PO36),
GSH= c(x$GSH12, x$GSH22, x$GSH36),
lyso= c(x$lyso12, x$lyso22, x$lyso36),
ProtLevel = c(x$ ProtLevel12, x$ProtLevel22, x$ProtLevel36),
POtoGSH = c(x$PO12toGSH12, x$PO22toGSH22, x$PO36toGSH36),
MuscleCol= c(x$MuscleCol, x$MuscleCol, x$MuscleCol),
Age=c(rep(12, length(x$PO12)),rep(22, length(x$PO22)),rep(36, length(x$PO36)) ),
Group.Number = c(x$Group.Number,x$Group.Number,x$Group.Number),
ID = c(x$ID, x$ID, x$ID))
x.tab <- as.data.frame(x.tab)
sepd <-format(as.Date(x$Sep.Date), "%Y-%m")
x.tab <- cbind(x.tab, Sep.Date=sepd);sepd
x.tab <- x.tab[  (x.tab$Age==12 & x.tab$Group.Number ==1) |
(x.tab$Age==22 & x.tab$Group.Number ==2) |
(x.tab$Age==36 & x.tab$Group.Number ==7) , ]
table(x.tab$Group.Number)
par(mfrow=c(2,2))
# PO
hist(x.tab$PO)
boxplot(lyso ~ as.factor(Age), data =x.tab,
pch=19, las=1, ylim= c(0, 10), outline=F,
ylab="lysozyme-like activity [µg/mL]")
table(x.tab[!is.na(x.tab$PO),]$Age)
table(x.tab[!is.na(x.tab$lyso),]$Age)
table(x.tab[!is.na(x.tab$GSH),]$Age)
x <- d.sum[is.element(d.sum$Group.Number,c(1:7)),]
x <- x[x$IsMated & x$IsEggComplete & x$EventDay==36 & x$EventType=="C" , ]
fisher.test(print(table(x$MuscleCol, x$Group.Number)), simulate.p.value = T)
chisq.test(print(table(x$MuscleCol, x$Group.Number)))
sum(print(table(x$MuscleCol, x$Group.Number)))
x <- d.sum[is.element(d.sum$Group.Number,c(1:8)),]
x <- x[x$IsMated & x$IsEggComplete & x$EventDay==36 & x$EventType=="C" , ]
fisher.test(print(table(x$MuscleCol, x$Group.Number)), simulate.p.value = T)
chisq.test(print(table(x$MuscleCol, x$Group.Number)))
sum(print(table(x$MuscleCol, x$Group.Number)))
x <- d.sum[is.element(d.sum$Group.Number,c(7:8)),]
x <- x[x$IsMated & x$IsEggComplete & x$EventDay==36 & x$EventType=="C" , ]
fisher.test(print(table(x$MuscleCol, x$Group.Number)), simulate.p.value = T)
chisq.test(print(table(x$MuscleCol, x$Group.Number)))
sum(print(table(x$MuscleCol, x$Group.Number)))
par(mfrow=c(2,2))
shapiro.test(2^(-cqsum$DN43530.nor))
shapiro.test(2^(-cqsum$DN48887.nor))
shapiro.test(2^(-cqsum$DN46820.nor))
shapiro.test(2^(-cqsum$Vtg1.nor))
beeswarm(2^(-DN43530.nor)/max(2^(-cqsum$DN43530.nor)) ~ Tissue, data = cqsum, pch=19, col="#000000aa", ylab="PO(DN43530)", las=1)
means <- tapply (2^(-cqsum$DN43530.nor)/max(2^(-cqsum$DN43530.nor)), cqsum$Tissue, mean, na.rm=T)
for (i in 1:3){segments (i-.2, means[i], i+.2, means[i], lwd=3, col="red")}
boxplot(2^(-DN43530.nor)/max(2^(-cqsum$DN43530.nor)) ~ Tissue, data = cqsum, pch=19, ylab="PO(DN43530)", las=1, outline=T)
wilcox.test(DN43530.nor~ Tissue, data=cqsum)
res1 <- glm(2^(-DN43530.nor) ~ Tissue, data = cqsum, family = Gamma(link="log"))
res2 <- glm(2^(-DN43530.nor) ~ 1     , data = cqsum, family = Gamma(link="log"))
AIC(res1); AIC(res2); AIC(res1)- AIC(res2)
beeswarm(2^(-DN48887.nor)/max(2^(-cqsum$DN48887.nor)) ~ Tissue, data = cqsum, pch=19, col="#000000aa", ylab="PO(DN48887)", las=1 )
means <- tapply (2^(-cqsum$DN48887.nor)/max(2^(-cqsum$DN48887.nor)), cqsum$Tissue, mean, na.rm=T)
for (i in 1:3){segments (i-.2, means[i], i+.2, means[i], lwd=3, col="red")}
boxplot(2^(-DN48887.nor)/max(2^(-cqsum$DN48887.nor)) ~ Tissue, data = cqsum, pch=19, ylab="PO(DN48887)", las=1, outline=T)
wilcox.test(DN48887.nor~ Tissue, data=cqsum)
res1 <- glm(2^(-DN48887.nor) ~ Tissue, data = cqsum, family = Gamma(link="log"))
res2 <- glm(2^(-DN48887.nor) ~ 1     , data = cqsum, family = Gamma(link="log"))
AIC(res1); AIC(res2); AIC(res1)- AIC(res2)
summary(res1)
beeswarm(2^(-DN46820.nor)/max(2^(-cqsum$DN46820.nor)) ~ Tissue, data = cqsum, pch=19, col="#000000aa", ylab="PO(DN46820)", las=1 )
means <- tapply (2^(-cqsum$DN46820.nor)/max(2^(-cqsum$DN46820.nor)), cqsum$Tissue, mean, na.rm=T)
for (i in 1:3){segments (i-.2, means[i], i+.2, means[i], lwd=3, col="red")}
boxplot(2^(-DN46820.nor)/max(2^(-cqsum$DN46820.nor)) ~ Tissue, data = cqsum, pch=19, ylab="PO(DN46820)", las=1, outline=T)
wilcox.test(DN46820.nor~ Tissue, data=cqsum)
res1 <- glm(2^(-DN46820.nor) ~ Tissue, data = cqsum, family = Gamma(link="log"))
res2 <- glm(2^(-DN46820.nor) ~ 1     , data = cqsum, family = Gamma(link="log"))
AIC(res1); AIC(res2); AIC(res1)- AIC(res2)
summary(res1)
beeswarm(2^(-Vtg1.nor)/max(2^(-cqsum$Vtg1.nor)) ~ Tissue, data = cqsum , pch=19, col="#000000aa", ylab="Vtg1", las=1)
means <- tapply (2^(-cqsum$Vtg1.nor)/max(2^(-cqsum$Vtg1.nor)), cqsum$Tissue, mean, na.rm=T)
for (i in 1:3){segments (i-.2, means[i], i+.2, means[i], lwd=3, col="red")}
boxplot(2^(-Vtg1.nor)/max(2^(-cqsum$Vtg1.nor)) ~ Tissue, data = cqsum, pch=19, ylab="Vtg1", las=1, outline=T)
wilcox.test(Vtg1.nor~ Tissue, data=cqsum)
res1 <- glm(2^(-Vtg1.nor) ~ Tissue, data = cqsum, family = Gamma(link="log"))
res2 <- glm(2^(-Vtg1.nor) ~ 1     , data = cqsum, family = Gamma(link="log"))
AIC(res1); AIC(res2); AIC(res1)- AIC(res2)
summary(res1)
setwd("~/Google Drive/GitHub/2017Gtexensis_TerRep/Paper 1/PLOS ONE - R1/Final 2019-0317/")
load("Main_3.0.0_2019-0221.RData")
setwd("~/Google Drive/GitHub/2019-PLOSONE/")
load("Main_3.0.0_2019-0221.RData")
load("Datafile.RData")
library(knitr)
library(beeswarm)
library(colormap)
library(dplyr)
library(randomForest)
library(dichromat)
library(lme4)
library(lmerTest)
library(mcmc)
library(MCMCglmm)
library(MASS)
library(survival)
d.sum <- d.sum[!is.na(d.sum$ID),]
